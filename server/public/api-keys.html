<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ICI.ndex API Keys</title>
    <style>
      body { font-family: Arial, sans-serif; max-width: 760px; margin: 40px auto; padding: 0 20px; }
      h1 { font-size: 22px; }
      label { display:block; margin-top: 16px; }
      input, button { width: 100%; padding: 10px; margin-top: 6px; }
      .box { border: 1px solid #ddd; padding: 16px; margin-top: 20px; }
    </style>
  </head>
  <body>
    <h1>ICI.ndex API Access</h1>
    <p>Purchase a subscription to receive your API key.</p>
    <div class="box">
      <label>Email for checkout</label>
      <input id="email" placeholder="you@email.com" />
      <button id="buy">Start Subscription</button>
    </div>

    <div class="box">
      <label>Verify your API key</label>
      <input id="key" placeholder="ici_..." />
      <button id="verify">Verify Key</button>
      <pre id="status"></pre>
    </div>

    <script>
      document.getElementById('buy').onclick = async () => {
        const email = document.getElementById('email').value;
        const res = await fetch('/v1/checkout', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email })
        });
        const data = await res.json();
        if (data.url) window.location.href = data.url;
      };

      document.getElementById('verify').onclick = async () => {
        const key = document.getElementById('key').value;
        const res = await fetch('/v1/key/verify', {
          headers: { Authorization: `Bearer ${key}` }
        });
        const data = await res.json();
        document.getElementById('status').textContent = JSON.stringify(data, null, 2);
      };
    </script>
  </body>
</html>
